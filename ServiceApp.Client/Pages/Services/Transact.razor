@page "/transact"
@using ServiceApp.Client.Enum.StaticClass
@using ServiceApp.Shared.Enum
@using ServiceApp.Shared.Model
@using ServiceApp.Shared.Model.Services.Accounting
@using ServiceApp.Shared.Model.Services.Accounting.SubServices
@using ServiceApp.Shared.Model.Services.OtherServices
@inject IDialogService DialogService
@inject NavigationManager NavigationManager
@inject ClientInfo ClientInfo
@inject IAccounting Accounting
@inject IOtherServices OtherServices

<style>
    .pa-10 {
        padding: 20px !important;
    }

    .mud-button-label{
        justify-content: start;
    }
</style>

<MudTabs Elevation="4" Rounded="true" Centered="false" Color="@Color.Primary" Class="container sm-10" @bind-ActivePanelIndex="@ActivePanel">
    <MudTabPanel Text="Services">
        <MudGrid Class="d-flex justify-center">
            <MudItem xs="12">
                <MudPaper Class="pa-10">
                    <div class="container  mt-4">
                        <MudText Typo="Typo.h5">Client Info</MudText>
                        <MudText Typo="Typo.body2" Class="mud-text-secondary">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla cursus mauris id lorem finibus, non condimentum risus ultricies.</MudText>
                    </div>
                    <MudDivider DividerType="DividerType.Middle" Class="my-6" Style="height: 2px" />
                    <div class="container  mt-4">
                        <MudButton @onclick="OpenDialog" Variant="Variant.Filled" Color="Color.Primary">Choose existing client</MudButton>
                    </div><br>
                    <form>
                        <div class="container">
                            <div class="row mb-4">
                                <div class="col">
                                    <div data-mdb-input-init class="form-outline">
                                        <MudTextField @bind-Value="ClientInfo.FirstName" Label="First Name" Variant="Variant.Text"></MudTextField><br>
                                    </div>
                                    <div data-mdb-input-init class="form-outline">
                                        <MudTextField @bind-Value="ClientInfo.LastName" Label="Last Name" Variant="Variant.Text"></MudTextField><br>
                                    </div>
                                    <div data-mdb-input-init class="form-outline mb-4">
                                        <MudTextField @bind-Value="ClientInfo.TinNo" Label="Tin Number" Variant="Variant.Text"></MudTextField><br>
                                    </div>
                                </div>
                                <div class="col">
                                    <div data-mdb-input-init class="form-outline mb-4">
                                        <MudTextField @bind-Value="ClientInfo.Address" Label="Address" Variant="Variant.Text"></MudTextField><br>
                                    </div>
                                    <div data-mdb-input-init class="form-outline mb-4">
                                        <MudTextField @ref="multilineReference" T="string" Label="Additional Information" Lines="3" TextChanged="OnValueChangeHandler" Variant="Variant.Outlined" Text="" Adornment="Adornment.End" AdornmentIcon="@Icons.Material.Filled.Api" OnAdornmentClick="@(() => multilineReference.SelectAsync())" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </MudPaper>
            </MudItem>
            <MudItem xs="12">
                <MudPaper Class="pa-10">
                    <div class="container  mt-4">
                        <MudText Typo="Typo.h5">Services</MudText>
                        <MudText Typo="Typo.body2" Class="mud-text-secondary">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla cursus mauris id lorem finibus, non condimentum risus ultricies.</MudText>
                    </div>
                    <MudDivider DividerType="DividerType.Middle" Class="my-6" Style="height: 2px" /><br>
                        @foreach (string service in this.Services)
                        {
                            bool expanded = expandedStates.ContainsKey(service) ? expandedStates[service] : false;
                            <div class="container text-start">
                                <MudStack Spacing="2">
                                    <MudButton OnClick="() => OnExpandCollapseClick(service)">@(expanded ? $"Available services for {service}" : service)</MudButton>
                                    <MudDivider />
                                    <MudCollapse Expanded="expanded">
                                    @if (service == MainServices.Accounting)
                                    {
                                        foreach (string subservice in AccountingServices)
                                        {
                                            <MudForm>
                                                <MudCheckBox T="bool" ValueChanged="(isCheck) => HandleCheck(isCheck, subservice, MainServices.Accounting)">@subservice</MudCheckBox>
                                                 <MudForm Style="margin-left:35px;">
                                                     <MudText>Ownership Type:</MudText>
                                                    <MudRadioGroup T="string" ValueChanged="(option) => OnSelectedOptionChanged(option, subservice)">
                                                     <MudRadio Value="@(OwnerType.SoleProprietorship.ToString())">@OwnerType.SoleProprietorship</MudRadio>
                                                         <MudRadio Value="@(OwnerType.Corporate.ToString())">@OwnerType.Corporate</MudRadio>
                                                     </MudRadioGroup>
                                                     <MudStack Row>
                                                         <MudText Class="align-self-center">Service Fee:</MudText>
                                                        @if (subservice == SubServices.Filingoftaxes)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.FilingOfTaxes.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.BIRRegistration)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.BIRRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.ITRPreparation)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.ITRPreparation.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.DTIRegistration)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.DTIRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.SECRegistration)
                                                        { 
                                                            <MudTextField @bind-Value="@Accounting.SECRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.BusinessPermit)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.BusinessPermit.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.PagIbigRegistration)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.PagIbigRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.SSSRegistration)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.SSSRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.PhilhealthRegistration)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.PhilhealthRegistration.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                        @if (subservice == SubServices.BookKeeping)
                                                        {
                                                            <MudTextField @bind-Value="@Accounting.Bookkeeping.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                        }
                                                     </MudStack>
                                                 </MudForm>
                                               <br>
                                               </MudForm>
                                        }
                                    }
                                    else if (service == MainServices.OtherServices)
                                    {
                                        foreach (string subservice in OtherService)
                                        {
                                            <MudForm>
                                                <MudCheckBox T="bool" ValueChanged="(isCheck) => HandleCheck(isCheck, subservice, MainServices.OtherServices)">@subservice</MudCheckBox>
                                                    <MudForm Style="margin-left:35px;">
                                                    @if (subservice == SubServices.Weddingmanagement)
                                                    {
                                                        <MudText>Ownership Type:</MudText>
                                                        <MudRadioGroup T="string" ValueChanged="(option) => OnSelectedOptionChanged(option, subservice)">
                                                            <MudRadio Value="@(OwnerType.SoleProprietorship.ToString())">@OwnerType.SoleProprietorship</MudRadio>
                                                                <MudRadio Value="@(OwnerType.Corporate.ToString())">@OwnerType.Corporate</MudRadio>
                                                         </MudRadioGroup>
                                                    }
                                                     <MudStack Row>
                                                         <MudText Class="align-self-center">Service Fee:</MudText>
                                                            @if (subservice == SubServices.TransferofTitle)
                                                            {
                                                                <MudTextField @bind-Value="@OtherServices.TransferofTitle.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                            }
                                                            @if (subservice == SubServices.PCABAssistance)
                                                            {
                                                                <MudTextField @bind-Value="@OtherServices.PCABAssistance.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                            }
                                                            @if (subservice == SubServices.NBIAssistance)
                                                            {
                                                                 <MudTextField @bind-Value="@OtherServices.NBIAssistance.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                            }
                                                            @if (subservice == SubServices.Weddingmanagement)
                                                            {
                                                                 <MudTextField @bind-Value="@OtherServices.WeddingManagement.Fee" Label="Fee" Variant="Variant.Outlined" Margin="Margin.Dense" />
                                                            }
                                                    </MudStack>
                                                </MudForm>
                                                <br>
                                            </MudForm>
                                        }
                                    }
                                    else if (service == MainServices.PSA)
                                    {
                                        
                                    }
                                    else if (service == MainServices.DFA)
                                    {

                                    }
                                    else if (service == MainServices.NOTARY)
                                    {

                                    }
                                    else if (service == MainServices.LTO)
                                    {

                                    }
                                    else if (service == MainServices.Airline)
                                    {

                                    }
                                    else if (service == MainServices.VISA)
                                    {

                                    }
                                    else if (service == MainServices.Financial)
                                    {

                                    }
                                    else
                                    {

                                    }
                                </MudCollapse>
                                </MudStack>
                              </div>
                            <br>
                        }
                        <div class="container  mt-4 text-end">
                        <MudButton OnClick="@(()=>GoToTab(1))" Variant="Variant.Filled" Color="Color.Primary">Proceed</MudButton>
                        </div><br>
                    </MudPaper>
                </MudItem>
            </MudGrid>
    </MudTabPanel>
    <MudTabPanel Text="Summary">
        <Summary></Summary>
    </MudTabPanel>
</MudTabs>
    


